import{r as e,m as a,o as s,n as t,c as o,a as l,i as n,b as c,d as u,e as r,t as i,p as g,j as A,g as d}from"./index-Bt9QHR78.js";import{e as p}from"./eventBus.Dd2tFV_G.js";import{_ as m,c as v,p as h}from"./_plugin-vue_export-helper.AdHRmyGx.js";const w=m({__name:"index",setup(m){const w=e(!1),I=e(""),b=e("url('@/static/images/Ellipse 1.png')"),f=e("url('@/static/images/Ellipse 2.png')"),k=e("杭州西湖"),Q=a((()=>({backgroundImage:b.value,backgroundSize:"cover",backgroundPosition:"center"})));let y=null;function B(){I.value=(new Date).toLocaleTimeString()}const D=()=>{const e=localStorage.getItem("token");return console.log("从local中获取",e),!!e};async function C(){if(w.value)return void console.warn("已经打卡，无法重复打卡。");w.value=!0,b.value="url('@/static/images/Ellipse 2.png')",console.log("-------",b.value);const e=(new Date).toLocaleString();try{const e=await h({param:'localStorage.getItem("param", param)'});console.log("打卡响应:",e),showToast("打卡成功","success")}catch(a){console.error("打卡失败:",a),showToast("打卡失败，请重试","error")}console.log(`打卡成功，时间为: ${e}`),function(e){try{p.emit("punchData",{isPunched:!0,time:e}),console.log("发送打卡数据:",{isPunched:!0,punchTime:e})}catch(a){console.error("发送打卡数据失败:",a)}}(e)}return s((async()=>{if(console.log(!D()),D()){B(),y=setInterval(B,1e3);try{const e=await v({param:localStorage.getItem("param")});console.log("Punched status",e),w.value=Boolean(e.is_clock),k.value=e.point,console.log("Punched status","已登录"),console.log("Punched status",e.is_clock),console.log("Punched status",w.value),w.value&&(b.value=f.value)}catch(e){console.error("获取打卡状态错误:",e)}}else console.error("用户未登录")})),t((()=>{clearInterval(y)})),(e,a)=>{const s=A,t=d,p=n;return c(),o(p,{class:"content"},{default:l((()=>[u(p,{class:"address"},{default:l((()=>[u(s,{style:{width:"24px",height:"24px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAArVJREFUSEvFlt9LU2EYx5/nOQsKNnOm4rwr6Neoi4EUFV3osB926TakoqsQ6qKbiFCh5r+Q/QNhmc1JCFm5pYIXEaXlRUgS1IXbmEedkVC091cc51nHNXe2QDpweF8O53w/7/N9nud9D8I2X7jN+vD/AZPhSYf3sLcDFV4Ehk0ksRYZraCEt8BgwH3dPYCIaisnSkaw+Gxxn2JqEAU2AUcgjoACAY1xYw4MZjG7s7361q6vxSBbAtJj6b0qq96gwDpTzBjzICuM0ZLKyhPVXdVfCiFFAeFwmDqPd75DgT7ravNzSwS5ZwTIYXrmx8zJ5nAzt0KKAlJjqUsgod9qBzAYdgjH3fGR8fmWtpb99It6UWLQBIAhy+jK7h7nQ3tAPDUKHM6bAOAw1BBo6AAAazJxtW/1CUgMkDAiQACBL6u6nG22gGQ8uYQC95iWSC69jYHGT4X+rt1b8wqQH3O5ASBGy64eZ70tIPEqIQ1f16uGI0w9mtoRGgqJQkAkGNHOnD7LcguB9Vy4up1kC0jGkjoIrKWNklRZdcQT8swVApb7vh9yKDmXTz7DFVePq84WkIqlnoOEc+aHiqlhT9ATKsxB5v63QRIQNHNFnF44u50XbAELsYXLJKifBCkTAgyimtLuTDyd+Oz3+w8CQC9Jrd1auopheVWkIkpLu9LvQcDRzV2b62QzN/lu5ggao9npn9PHyuoDI8TEaOKAJrXXKLDGKrRJ3GgwsV5BGWJ4qup21XxZnWy+pI/oPiFlnCyQv7qZY0Zx1eq+6f5Q0V6Uh0R1nwT1B2JuE7kxAwJa3TeKixsaZZ0HelT3KabiJClnl3EzymC2tHjZAONF/bHuA0FxFFBDHDOUpVb3ta1XbjpQVgR5ux7oPlQYUdwRqr9qL15RBCbEOOEKS7HUuV5RBP/yg7DtgN/2i04oIhPw/gAAAABJRU5ErkJggg==",mode:"aspectFill"}),u(t,null,{default:l((()=>[r(i(k.value),1)])),_:1})])),_:1}),u(p,{onClick:C,class:"punch-button",style:g(Q.value),disabled:w.value},{default:l((()=>[u(p,{style:{display:"grid","justify-items":"center"}},{default:l((()=>[u(t,null,{default:l((()=>[r(i(w.value?"已打卡":"打卡"),1)])),_:1}),u(t,{class:"time-text"},{default:l((()=>[r(i(I.value),1)])),_:1})])),_:1})])),_:1},8,["style","disabled"])])),_:1})}}},[["__scopeId","data-v-20b561da"]]);export{w as default};
